11/9/2019
command line - Why are the images produced by pdﬁmages diﬀerent when using the -all ﬂag? - Ask Ubuntu
https://askubuntu.com/questions/776679/why-are-the-images-produced-by-pdﬁmages-diﬀerent-when-using-the-all-ﬂag
1/3
Why are the images produced by pdfimages different when using the -
all flag?
 
Asked 3 years, 5 months ago
 
Active 8 days ago
 4k times
Viewed
5
1
It's my understanding that 
 extracts images from PDFs in their native formats.
pdfimages -all
Therefore, I expected that the JPG (lossy) images extracted from that command would have the
same pixel information as the .ppm and .pbm files produced without the 
 option, as well as the
PNG (lossless) files created when I right-click and save the image in Evince.
-all
However, my use of the ImageMagick 
 command tells me that there are differences in the
images contained within the JPG files compared to the other options above. To reproduce,
download the PDF in this link (
), use it as an argument for 
 and 
 and use the first .ppm file and the first .jpg file as arguments for 
. When I do this, it produces an image file containing red to indicate a difference in the
images.
compare
https://fccid.io/document.php?id=2149405
pdfimages
pdfimages -all
compare
Is there something that I don't understand? Is 
 adding pixel information by default when it
creates .ppm and .pbm files?
pdfimages
 
 
 
command-line
pdf
image-processing
imagemagick
edited Nov 1 at 17:15
Zanna
53.9k
15
150
253
asked May 24 '16 at 5:51
Orion751
38
1
5
 – 
 
Just how much difference is there between these images? Can you supply examples?
John1024 May 24
'16 at 6:38
 – 
 
@John1024 I'm trying to get images displaying the problem, but the PNG's seem to be too large for Stack
Overflow/Imgur.
Orion751 May 24 '16 at 22:30
 – 
 
 
@John1024 Would a link to a PDF source be of any help? To reproduce, download it, use it as an
argument for 
 and 
 and use the first .ppm file and the first .jpg file as
arguments for 
. When I do this, it produces an image file containing red to indicate a difference
in the images - 
pdfimages
pdfimages -all
compare
fccid.io/document.php?id=2149405
Orion751 May 25 '16 at 3:36
 – 
 
I tried that and saw some red. I also tried using 
 to convert a jpg to ppm (no pdf involvement)
and then running 
 on the two; I still got differences. It might be that there are some rounding-
error issues with the conversion process that 
 detects.
convert
compare
convert
John1024 May 25 '16 at 7:18
 – 
 
 
@John1024 Are you suggesting that these rounding-error issues may also apply to 
?
Prior to using a newer version of 
 for the 
 flag, I was able to use 
 on the
example to convert it from .ppm to .png without getting red, but I also got red when I tried converting to .jpg
with it.
pdfimages -all
pdfimages
-all
convert
Orion751 May 26 '16 at 17:04


11/9/2019
command line - Why are the images produced by pdﬁmages diﬀerent when using the -all ﬂag? - Ask Ubuntu
https://askubuntu.com/questions/776679/why-are-the-images-produced-by-pdﬁmages-diﬀerent-when-using-the-all-ﬂag
2/3
 | 
1 Answer
7
 returns the 
 file that was stored in the pdf.
pdfimages -all
exact
We can test this by doing a round-trip: starting with a jpg image, we add it to a pdf using LaTeX,
extract it using 
, and then compare it to the original. (The reason for using LaTeX
will be explained later.)
pdfimages -all
I have the first jpg image as extracted from your link and I named it 
. Let's put it in a
PDF file using LaTeX:
device.jpg
$ cat img.tex  
\documentclass{article} 
\usepackage{graphicx} 
\begin{document} 
\includegraphics[width=5in,keepaspectratio]{device} 
\end{document} 
$ pdflatex img 
[...snip...] 
Output written on img.pdf (1 page, 672455 bytes). 
Transcript written on img.log. 
Now, let's extract it using 
 and compare it with the original:
pdfimages -all
$ pdfimages -all img.pdf img-all 
$ cmp device.jpg img-all-000.jpg  
$ 
The extracted jpg is 
 to the original.
byte-for-byte identical
Footnote: the reason for using LaTeX
The above test cannot be done using just any PDF creator. This is because not all PDF creators
will put images into a PDF unmolested. For example, let's try ImageMagick's 
:
convert
$ convert device.jpg device.pdf 
$ pdfimages -all device.pdf device-all 
$ cmp device.jpg device-all-000.jpg  
device.jpg device-all-000.jpg differ: byte 4, line 1 
 re-sampled the image to a smaller size before placing it in the pdf.
convert
$ ls -1s device.jpg device-all-000.jpg  
528 device-all-000.jpg 
656 device.jpg 
Image accuracy was part of pdflatex's design goals. Other PDF creation software may, by default,
"optimize" images before placing them in the PDF.


11/9/2019
command line - Why are the images produced by pdﬁmages diﬀerent when using the -all ﬂag? - Ask Ubuntu
https://askubuntu.com/questions/776679/why-are-the-images-produced-by-pdﬁmages-diﬀerent-when-using-the-all-ﬂag
3/3
answered May 27 '16 at 19:40
John1024
11.1k
29
40


